<!DOCTYPE html>

<html>
<head>
  <meta charset="utf-8">
  <title>MeshNet Simulator</title>
  <link rel="stylesheet" type="text/css" href="style.css">

<!--
  <script src="https://d3js.org/d3-collection.v1.min.js"></script>
-->
  <script src="d3/d3-collection.v1.min.js"></script>
  <script src="d3/d3-dispatch.v1.min.js"></script>
  <script src="d3/d3-quadtree.v1.min.js"></script>
  <script src="d3/d3-timer.v1.min.js"></script>
  <script src="d3/d3-force.v1.min.js"></script>
  <script src="d3/d3-zoom.v1.min.js"></script>
  <script src="d3/d3-drag.v1.min.js"></script>
  <script src="d3/d3-selection.v1.min.js"></script>
  <script src="d3/d3-interpolate.v1.min.js"></script>
  <script src="d3/d3-ease.v1.min.js"></script>
  <script src="d3/d3-color.v1.min.js"></script>
  <script src="d3/d3-transition.v1.min.js"></script>

  <script src="node.js"></script>
  <script src="link.js"></script>
  <script src="packet.js"></script>
  <script src="math.js"></script>
  <script src="draw.js"></script>
  <script src="graph.js"></script>
  <script src="edit.js"></script>
  <script src="sim.js"></script>

<script>

function showTab(evt, tabname) {
  var tabcontent = document.getElementsByClassName("tabcontent");
  for (var i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  var tablinks = document.getElementsByClassName("tablinks");
  for (var i = 0; i < tablinks.length; i++) {
    tablinks[i].classList.remove('active');
  }

  document.getElementById(tabname).style.display = "block";
  evt.currentTarget.classList.add('active');
}

var graph;
var edit;
var sim;

function start() {
  graph = createGraph('graph');
  edit = createEdit(graph);
  sim = createSim(graph);
}

  </script>
</head>
<body onload="start()">
  <div id="container">
    <div id="toolbar">
      <div class="tab">
        <button class="tablinks" onclick="showTab(event, 'File')">File</button>
        <button class="tablinks" onclick="showTab(event, 'Edit')">Edit</button>
        <button class="tablinks" onclick="showTab(event, 'Sim')">Sim</button>
      </div>
      <div id="File" class="tabcontent">
        <fieldset>
        <legend>Files</legend>
        <div>
          <label>Graph</label>
          <input type="file" id="file_graph" value="">
        </div>
        <div>
          <label>Nodes</label>
          <input type="file" id="file_nodes" value="">
        </div>
        <div>
          <input type="button" onclick="edit.loadMeshViewerData('file_graph', 'file_nodes')" value="Load">
          <input type="button" onclick="edit.saveMeshViewerData()" value="Save">
        </div>
        </fieldset>
      </div>

      <div id="Edit" class="tabcontent">
        <fieldset>
          <legend>Selection</legend>
          <div>
            <input type="button" onclick="graph.extendSelection()" value="extend">
            <input type="button" onclick="graph.clearSelection()" value="clear">
            <fieldset>
              <legend>Modify</legend>
              <div>
                <input type="button" onclick="graph.removeSelection()" value="remove">
                <input type="button" onclick="graph.connectSelectedNodes()" value="connect">
                <input type="button" onclick="graph.disconnectSelectedNodes()" value="disconnect">
              </div>
            </fieldset>
          </div>
        </fieldset>
        <fieldset>
          <legend>Add Primitives</legend>
          <div>
            <input type="button" onclick="edit.addSingle()" value="Node">
          </div>
          <div>
            <input type="button" onclick="edit.addLine('line_n', 'line_loop')" value="Line">
            <input type="number" id="line_n" min="1" max="999" value="3">
            <span>
              <input type="checkbox" id="line_loop">
              <label>Loop</label>
            </span>
          </div>
          <div>
            <input type="button" onclick="edit.addStar('star_n')" value="Star">
            <input type="number" id="star_n" min="1" max="999" value="4">
          </div>
          <div>
            <input type="button" onclick="edit.addLattice('lattice_x', 'lattice_y')" value="lattice">
            <input type="number" id="lattice_x" min="1" max="999" value="3">
            <span>x</span>
            <input type="number" id="lattice_y" min="1" max="999" value="3">
          </div>
          <!--
          <div>
            <input type="button" onclick="edit.addLayer('layer_x', 'layer_y')" value="add layer">
            <input type="number" id="layer_x" min="3" max="999" value="3">
            <input type="number" id="layer_y" min="3" max="999" value="3">
          </div>
          -->
        </fieldset>
        <fieldset>
          <legend>Change Link Quality</legend>
          <div>
            <select id="tq_type">
              <option value="fixed">Fixed</option>
              <option value="random">Random</option>
            </select>
            <input type="number" id="tq_value" min="0" max="10" value="1.0">
            <input type="button" onclick="edit.changeLinkQuality('tq_type', 'tq_value')" value="Change">
          </div>
        </fieldset>
        <fieldset>
          <legend>Misc</legend>
          <div>
            <input type="button" onclick="graph.resetView()" value="reset view">
            <input type="button" onclick="graph.resetData()" value="reset data">
            <input type="button" onclick="graph.toggleAnimation()" value="toggle animation">
          </div>
        </fieldset>
      </div>

      <div id="Sim" class="tabcontent">
        <fieldset>
          <legend>Simulator</legend>
          <div>
            <input type="button" onclick="sim.step('sim_steps')" value="step">
            <input type="number" id="sim_steps" min="1" max="99999" value="1">
            <input type="button" onclick="sim.reset()" value="reset">
          </div>
          <div><label>Total Steps</label></div>
        </fieldset>
        <fieldset>
          <legend>Statistics</legend>
          <fieldset>
            <legend>Packets</legend>
            <div><label>Total</label></div>
            <div><label>Active</label></div>
            <div><label>Lost</label></div>
            <div><label>Efficiency</label></div>
          </fieldset>
          <fieldset>
            <legend>Graph</legend>
            <div><label>Links:</label></div>
            <div><label>Nodes:</label></div>
          </fieldset>
        </fieldset>
      </div>
    </div>
    <div id="graph" class="graph">
    </div>
  </div>
  <noscript>
    <strong>JavaScript required</strong>
  </noscript>
</body>
</html>
